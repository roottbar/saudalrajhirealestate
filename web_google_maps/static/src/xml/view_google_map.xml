<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="web_google_maps.GoogleMapView.MapView" owl="1">
        <div class="o_google_map_container">
            <div class="o_google_map_view" tabindex="-1" t-ref="map_container">
                <div class="o_google_map_view"></div>
            </div>
            <div class="o_map_right_sidebar open" t-ref="sidebar">
                <div class="content">
                    <GoogleMapSidebar 
                        t-if="props.model and props.model.data"
                        parent="this"
                        records="props.model.data"
                        title="props.sidebarTitle"
                        subtitle="props.sidebarSubtitle"
                        onOpenRecord.bind="(ev) => props.controller.openRecord(ev.id)"
                    />
                </div>
                <div class="toggle_right_sidenav">
                    <button 
                        data-toggle="tooltip" 
                        data-placement="right" 
                        title="Expand side panel"
                        t-on-click="onToggleRightSidenav"
                    ></button>
                </div>
            </div>
        </div>
    </t>

    <t t-name="web_google_maps.GoogleMapView.buttons" owl="1">
        <div class="o_list_buttons">
            <div class="o_form_marker_buttons_actions pb-2">
                <button 
                    t-if="props.canCreate"
                    type="button" 
                    class="btn btn-primary o-map-button-new" 
                    accesskey="c"
                    t-on-click="props.onButtonNew"
                >
                    <t t-esc="props.create_text || 'Create'"/>
                </button>
                <button 
                    type="button" 
                    class="btn btn-secondary o-map-button-center-map"
                    t-on-click="props.onButtonMapCenter"
                >
                    Center Map
                </button>
            </div>
            <div class="o_form_marker_buttons_edit o_hidden">
                <button 
                    type="button" 
                    class="btn btn-primary o-map-button-marker-save"
                    t-on-click="props.onButtonSaveMarker"
                >
                    Save
                </button>
                <button 
                    type="button" 
                    class="btn btn-secondary o-map-button-marker-discard"
                    t-on-click="props.onButtonDiscardMarker"
                >
                    Discard
                </button>
            </div>
        </div>
    </t>

    <t t-name="web_google_maps.GoogleMapView.Sidebar" owl="1">
        <div class="o_map_sidebar">
            <div class="pt-3 ml-3">
                <h3>
                    <t t-esc="props.parent.viewTitle"/>
                </h3>
            </div>
            <ul class="list-group">
                <t t-foreach="props.records" t-as="record" t-key="record.id">
                    <t t-set="title" t-value="getTitle(record)"/>
                    <t t-set="subtitle" t-value="getSubtitle(record)"/>
                    <t t-set="has_geolocation" t-value="hasGeolocation(record)"/>
                    <t t-set="marker_color" t-value="getMarkerColor(record)"/>
                    <t t-if="has_geolocation">
                        <li class="list-group-item d-flex justify-content-between align-items-center pb-1 pt-1">
                            <a 
                                href="#" 
                                class="flex-grow-1 o_map_sidebar_record" 
                                t-att-data-id="record.id" 
                                t-att-data-res-id="record.res_id" 
                                t-attf-style="color: {{marker_color}};"
                                t-on-click="onClickSidebarRecord"
                            >
                                <span class="title" t-esc="title"/>
                                <br/>
                                <i class="fa fa-map-marker"></i>
                                <small class="text-muted" t-if="subtitle" t-esc="subtitle"/>
                            </a>
                            <button 
                                type="button" 
                                class="btn btn-sm btn-light" 
                                data-toggle="tooltip" 
                                title="Open form"
                                t-on-click="openRecord"
                            >
                                <i class="fa fa-wpforms"></i>
                            </button>
                        </li>
                    </t>
                    <t t-else="">
                        <li class="list-group-item d-flex justify-content-between align-items-center pb-1 pt-1 disabled">
                            <a 
                                href="#" 
                                class="flex-grow-1 o_map_sidebar_record" 
                                data-toggle="tooltip" 
                                title="No geolocation" 
                                t-att-data-id="record.id" 
                                t-attf-style="color: {{marker_color}};"
                            >
                                <span class="title" t-esc="title"/>
                                <small class="text-muted" t-if="subtitle">
                                    <br/>
                                    <t t-esc="subtitle"/>
                                </small>
                            </a>
                            <button 
                                type="button" 
                                class="btn btn-sm btn-light" 
                                data-toggle="tooltip" 
                                title="Open form"
                                t-on-click="openRecord"
                            >
                                <i class="fa fa-wpforms"></i>
                            </button>
                        </li>
                    </t>
                </t>
            </ul>
        </div>
    </t>

    <t t-name="web_google_maps.GplacesAutocompleteField" owl="1">
        <input 
            type="text" 
            class="o_input" 
            t-ref="input"
            t-att-value="props.record.data[props.name]"
            t-att-placeholder="props.placeholder"
            t-on-change="onChange"
        />
    </t>

    <t t-name="web_google_maps.GplacesAddressAutocompleteField" owl="1">
        <input 
            type="text" 
            class="o_input" 
            t-ref="input"
            t-att-value="props.record.data[props.name]"
            t-att-placeholder="props.placeholder || 'Enter address'"
            t-on-change="onChange"
        />
    </t>
</templates>

