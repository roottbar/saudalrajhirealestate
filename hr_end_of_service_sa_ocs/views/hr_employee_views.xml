<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        
        <!-- Inherit Employee Form View -->
        <record id="view_employee_form_end_of_service" model="ir.ui.view">
            <field name="name">hr.employee.form.end.of.service</field>
            <field name="model">hr.employee</field>
            <field name="inherit_id" ref="hr.view_employee_form"/>
            <field name="arch" type="xml">
                
                <!-- Add buttons to button box -->
                <div name="button_box" position="inside">
                    <button name="action_view_end_of_service" type="object" class="o_stat_button" icon="fa-money" invisible="('end_of_service_count', '=', 0)">
                        <field name="end_of_service_count" widget="statinfo" string="تصفيات نهاية الخدمة"/>
                    </button>
                    <button name="action_view_annual_leave_settlements" type="object" class="o_stat_button" icon="fa-calendar" invisible="('annual_leave_settlement_count', '=', 0)">
                        <field name="annual_leave_settlement_count" widget="statinfo" string="تصفيات الإجازة السنوية"/>
                    </button>
                </div>
                
                <!-- Add new page for End of Service Information -->
                <notebook position="inside">
                    <page string="تصفيات نهاية الخدمة" name="end_of_service_info">
                        <group>
                            <group name="service_info" string="معلومات الخدمة">
                                <field name="hire_date"/>
                                <field name="probation_period_months"/>
                                <field name="is_probation_completed" readonly="1"/>
                                <field name="has_end_of_service" readonly="1"/>
                                <field name="last_end_of_service_date" readonly="1" invisible="('has_end_of_service', '=', False)"/>
                            </group>
                            <group name="quick_actions" string="إجراءات سريعة">
                                <button name="action_create_end_of_service" string="إنشاء تصفية نهاية خدمة" type="object" class="btn-primary" invisible="('active', '=', False)"/>
                                <button name="action_create_annual_leave_settlement" string="إنشاء تصفية إجازة سنوية" type="object" class="btn-secondary" invisible="('active', '=', False)"/>
                            </group>
                        </group>
                        
                        <separator string="تصفيات نهاية الخدمة السابقة"/>
                        <field name="end_of_service_ids" readonly="1">
                            <list string="تصفيات نهاية الخدمة" decoration-info="state=='draft'" decoration-success="state=='approved'" decoration-warning="state=='confirmed'">
                                <field name="calculation_date"/>
                                <field name="termination_type"/>
                                <field name="service_years"/>
                                <field name="end_of_service_benefit"/>
                                <field name="net_amount"/>
                                <field name="state" widget="badge"/>
                            </list>
                        </field>
                        
                        <separator string="تصفيات الإجازة السنوية"/>
                        <field name="annual_leave_settlement_ids" readonly="1">
                            <list string="تصفيات الإجازة السنوية" decoration-info="state=='draft'" decoration-success="state=='approved'" decoration-warning="state=='confirmed'">
                                <field name="calculation_date"/>
                                <field name="settlement_type"/>
                                <field name="remaining_leave_days"/>
                                <field name="settlement_amount"/>
                                <field name="net_amount"/>
                                <field name="state" widget="badge"/>
                            </list>
                        </field>
                    </page>
                </notebook>
                
            </field>
        </record>
        
        <!-- Inherit Employee Tree View -->
        <record id="view_employee_tree_end_of_service" model="ir.ui.view">
            <field name="name">hr.employee.tree.end.of.service</field>
            <field name="model">hr.employee</field>
            <field name="inherit_id" ref="hr.view_employee_tree"/>
            <field name="arch" type="xml">
                <field name="work_phone" position="after">
                    <field name="hire_date" optional="hide"/>
                    <field name="has_end_of_service" optional="hide"/>
                    <field name="end_of_service_count" optional="hide"/>
                    <field name="annual_leave_settlement_count" optional="hide"/>
                </field>
            </field>
        </record>
        
        <!-- Employee Search View Enhancement -->
        <record id="view_employee_filter_end_of_service" model="ir.ui.view">
            <field name="name">hr.employee.search.end.of.service</field>
            <field name="model">hr.employee</field>
            <field name="inherit_id" ref="hr.view_employee_filter"/>
            <field name="arch" type="xml">
                <filter name="inactive" position="after">
                    <separator/>
                    <filter name="has_end_of_service" string="لديه تصفية نهاية خدمة" domain="[('has_end_of_service', '=', True)]"/>
                    <filter name="no_end_of_service" string="بدون تصفية نهاية خدمة" domain="[('has_end_of_service', '=', False)]"/>
                    <filter name="probation_completed" string="انتهت فترة التجربة" domain="[('is_probation_completed', '=', True)]"/>
                    <filter name="in_probation" string="في فترة التجربة" domain="[('is_probation_completed', '=', False)]"/>
                </filter>
            </field>
        </record>
        
    </data>
</odoo>
